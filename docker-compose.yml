services:
  frpc:
    build: .
    image: 8technologia/frpc:latest
    container_name: frpc
    restart: unless-stopped
    environment:
      - SERVER_ADDR=${SERVER_ADDR}
      - SERVER_PORT=${SERVER_PORT}
      - AUTH_TOKEN=${AUTH_TOKEN}
      - BOX_NAME=${BOX_NAME}
      - SOCKS5_PORT=${SOCKS5_PORT:-}
      - HTTP_PORT=${HTTP_PORT:-}
      - ADMIN_PORT=${ADMIN_PORT:-}
      - PROXY_USER=${PROXY_USER:-}
      - PROXY_PASS=${PROXY_PASS:-}
      - ADMIN_USER=${ADMIN_USER:-admin}
      - ADMIN_PASS=${ADMIN_PASS:-}
      - BANDWIDTH_LIMIT=${BANDWIDTH_LIMIT:-8MB}
      - WEBHOOK_URL=${WEBHOOK_URL:-}

    volumes:
      - ./config:/etc/frpc

    ports:
      - "7400:7400"

    healthcheck:
      test: [ "CMD", "curl", "-sf", "http://127.0.0.1:7400/healthz" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
